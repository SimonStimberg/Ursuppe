Max patch by Justin Robinson